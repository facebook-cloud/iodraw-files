```mermaid
sequenceDiagram
    participant A as 容灾密钥服务器（异地）
    participant B as 密钥服务器
    participant C as 堡垒机
    participant D as 灌装电脑
    participant E as ECU设备

    B->>B: 产生项目密钥
    A<<->>B: 公司双防火墙满足法规认证和传输加密要求

    A->>B: 实时备份（增量备份方式）
    B->>B: 密钥加密保存到数据库（建议AES-128及以上）
    deactivate B
    deactivate A

    activate C
    activate A
    activate E

    C<<->>E: 双认证 (建议TLS1.2及以上或其他安全方案)
    E-->>C: 双认证通过

    E->>A: 申请项目密钥（加密通信-建议AES256或其他安全方案)）
    A->>E: 发送项目密钥

    C->>C: 确保接收的密钥和发送的密钥相同，否则重发
    deactivate A
    C->>D: 灌装密钥
    deactivate C
    deactivate E

```